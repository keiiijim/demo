<html>
    <head>
        <meta name="viewport" content="width=device-width,initial-scale=1">
        <script async src="//www.googletagservices.com/tag/js/gpt.js"></script>
    
       　<script async src="prebid9.1.0.js"></script>

        <script>

		function getUrlParameter(name) {
    var url = window.location.href;
    name = name.replace(/[[]/, "\\[").replace(/[\]]/, "\\]");
    var regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
    var results = regex.exec(url);
    return results === null ? null : decodeURIComponent(results[1].replace(/\+/g, " "));
}

var dynamicId = getUrlParameter('id') || '204631'; // デフォルト値を設定

		
            var div_sizes = [[300, 250]];
            
            var PREBID_TIMEOUT = 10000;
            var FAILSAFE_TIMEOUT = 5000;

            var adUnits = [
                {
                    code: '/18339668/test_demo/prebid_300x250',
                    mediaTypes: {
                        banner: {
                            sizes: div_sizes
                        }
                    },
                    bids: [{
                        bidder: 'adg',
                        params: {
                            id: dynamicId
                        }
                    }]
                }
            ];

            // ======== DO NOT EDIT BELOW THIS LINE =========== //
            var googletag = googletag || {};
            googletag.cmd = googletag.cmd || [];
            googletag.cmd.push(function() {
                googletag.pubads().disableInitialLoad();
            });

            var pbjs = pbjs || {};
            pbjs.que = pbjs.que || [];

            pbjs.que.push(function() {
       
	
pbjs.setConfig({
		userSync: {
			auctionDelay: 500,
			userIds: [ {
				name: 'imuid',
				params: {
					cid: 5126
				}
			},
				 {
				name: 'novatiq',
				params: {
					useSharedId: false,
					useCallbacks: true,
					urlParams: {
						novatiqId: "snowflake",
						useStandardUuid: true,
						useSspId: false,
						useSspHost: false
					},
				}
			}]
		}
	});
		    
                
                
               　　pbjs.addAdUnits(adUnits);

                pbjs.requestBids({
                    bidsBackHandler: initAdserver,
                    timeout: PREBID_TIMEOUT
                });
            });
            

            function initAdserver() {
                if (pbjs.initAdserverSet) return;
                pbjs.initAdserverSet = true;
                googletag.cmd.push(function() {
                    pbjs.que.push(function() {
                        pbjs.setTargetingForGPTAsync();
                        googletag.pubads().refresh();
                    });
                });
            }
            // in case PBJS doesn't load
            setTimeout(function() {
                initAdserver();
            }, FAILSAFE_TIMEOUT);

            googletag.cmd.push(function() {
                googletag.defineSlot('/18339668/test_demo/prebid_300x250', div_sizes, 'div').addService(googletag.pubads());
                googletag.pubads().enableSingleRequest();
                googletag.enableServices();
            });

        </script>
 <script>
    // ページ読み込み時にUser IDsを取得して表示する関数
    function displayUserIds() {
      // pbjs.getUserIds()からの結果を取得
      const userIds = pbjs.getUserIds();

      // JSON形式で整形し、HTML要素に挿入
      document.getElementById("userIds").textContent = JSON.stringify(userIds, null, 2);
    }

    // Prebidが完全にロードされたらUser IDsを表示
    pbjs.que.push(function() {
      displayUserIds();
    });
  </script>
    </head>

    <body>
        <div style="height: 1000px;width: 100%;">
        <h2>Prebid.js Example</h2>
         <h5 id="slot-id">Div 300x250 枠ID:</h5>
        <div style="height: 300px;width: 250px;">
            <div id='div'>
                <script type='text/javascript'>
                    googletag.cmd.push(function() {
                        googletag.display('div');
                    });
                </script>
            </div>
        </div>
<h1>Prebid User IDs</h1>
  <pre id="userIds">Loading User IDs...</pre>
        
        </div>
	    <script type="text/javascript">
        // URLパラメータを取得する関数
        function getUrlParameter(name) {
            var url = window.location.href;
            name = name.replace(/[[]/, "\\[").replace(/[\]]/, "\\]");
            var regex = new RegExp("[\\?&]" + name + "=([^&#]*)");
            var results = regex.exec(url);
            return results === null ? null : decodeURIComponent(results[1].replace(/\+/g, " "));
        }

        // 枠IDを取得し、動的に挿入
        var slotId = getUrlParameter('id') || 'デフォルト枠ID';
        document.getElementById('slot-id').textContent += slotId; // 枠IDを表示
    </script>
    </body>

</html>
